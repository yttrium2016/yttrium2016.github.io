<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="RocketMQ环境搭建"><meta name="keywords" content="分布式,mq,消息队列"><meta name="author" content="杨振宇"><meta name="copyright" content="杨振宇"><title>RocketMQ环境搭建 | 杨振宇'Blog</title><link rel="shortcut icon" href="/my-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/gh/upupming/gitalk@36368e5dffd049e956cdbbd751ff96c28d8255cf/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '3.8.0'
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#RocketMQ环境搭建"><span class="toc-number">1.</span> <span class="toc-text">RocketMQ环境搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#官网"><span class="toc-number">1.1.</span> <span class="toc-text">官网</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#基本概念"><span class="toc-number">1.2.</span> <span class="toc-text">基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-消息模型（Message-Model）"><span class="toc-number">1.2.1.</span> <span class="toc-text">1 消息模型（Message Model）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-消息生产者（Producer）"><span class="toc-number">1.2.2.</span> <span class="toc-text">2 消息生产者（Producer）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-消息消费者（Consumer）"><span class="toc-number">1.2.3.</span> <span class="toc-text">3 消息消费者（Consumer）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-主题（Topic）"><span class="toc-number">1.2.4.</span> <span class="toc-text">4 主题（Topic）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-代理服务器（Broker-Server）"><span class="toc-number">1.2.5.</span> <span class="toc-text">5 代理服务器（Broker Server）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-名字服务（Name-Server）"><span class="toc-number">1.2.6.</span> <span class="toc-text">6 名字服务（Name Server）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-拉取式消费（Pull-Consumer）"><span class="toc-number">1.2.7.</span> <span class="toc-text">7 拉取式消费（Pull Consumer）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-推动式消费（Push-Consumer）"><span class="toc-number">1.2.8.</span> <span class="toc-text">8 推动式消费（Push Consumer）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-生产者组（Producer-Group）"><span class="toc-number">1.2.9.</span> <span class="toc-text">9 生产者组（Producer Group）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-消费者组（Consumer-Group）"><span class="toc-number">1.2.10.</span> <span class="toc-text">10 消费者组（Consumer Group）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-集群消费（Clustering）"><span class="toc-number">1.2.11.</span> <span class="toc-text">11 集群消费（Clustering）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-广播消费（Broadcasting）"><span class="toc-number">1.2.12.</span> <span class="toc-text">12 广播消费（Broadcasting）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-普通顺序消息（Normal-Ordered-Message）"><span class="toc-number">1.2.13.</span> <span class="toc-text">13 普通顺序消息（Normal Ordered Message）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-严格顺序消息（Strictly-Ordered-Message）"><span class="toc-number">1.2.14.</span> <span class="toc-text">14 严格顺序消息（Strictly Ordered Message）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#15-消息（Message）"><span class="toc-number">1.2.15.</span> <span class="toc-text">15 消息（Message）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#16-标签（Tag）"><span class="toc-number">1.2.16.</span> <span class="toc-text">16 标签（Tag）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#环境配置"><span class="toc-number">1.3.</span> <span class="toc-text">环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#linux"><span class="toc-number">1.3.1.</span> <span class="toc-text">linux</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#下载"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">下载</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#安装JDK环境"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">安装JDK环境</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MQ配置环境变量"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">MQ配置环境变量</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#配置修改"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">配置修改</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#启动"><span class="toc-number">1.3.1.5.</span> <span class="toc-text">启动</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#windows"><span class="toc-number">1.3.2.</span> <span class="toc-text">windows</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#下载-1"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">下载</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#安装JDK环境-1"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">安装JDK环境</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MQ配置环境变量-1"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">MQ配置环境变量</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#配置修改-1"><span class="toc-number">1.3.2.4.</span> <span class="toc-text">配置修改</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#启动-1"><span class="toc-number">1.3.2.5.</span> <span class="toc-text">启动</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试"><span class="toc-number">1.4.</span> <span class="toc-text">测试</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#提供者-会发送1000条消息到broker"><span class="toc-number">1.4.0.1.</span> <span class="toc-text">提供者 会发送1000条消息到broker</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#消费者-会接受1000条消息"><span class="toc-number">1.4.0.2.</span> <span class="toc-text">消费者 会接受1000条消息</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#可视化服务"><span class="toc-number">1.5.</span> <span class="toc-text">可视化服务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#仓库地址"><span class="toc-number">1.5.1.</span> <span class="toc-text">仓库地址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#编译"><span class="toc-number">1.5.2.</span> <span class="toc-text">编译</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#启动-2"><span class="toc-number">1.5.3.</span> <span class="toc-text">启动</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查看"><span class="toc-number">1.5.4.</span> <span class="toc-text">查看</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://raw.githubusercontent.com/yttrium2016/img/master/20190222151701.png"></div><div class="author-info__name text-center">杨振宇</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">23</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">30</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">7</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">杨振宇'Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">博客</a><a class="site-page" href="/archives">归档</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a></span></div><div id="post-info"><div id="post-title">RocketMQ环境搭建</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-01</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/后台/">后台</a><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">1.9k</span><span class="post-meta__separator">|</span><span>阅读时长: 6 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h2 id="RocketMQ环境搭建"><a href="#RocketMQ环境搭建" class="headerlink" title="RocketMQ环境搭建"></a>RocketMQ环境搭建</h2><h3 id="官网"><a href="#官网" class="headerlink" title="官网"></a>官网</h3><p><a href="http://rocketmq.apache.org/" target="_blank" rel="noopener">http://rocketmq.apache.org/</a></p>
<h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><h4 id="1-消息模型（Message-Model）"><a href="#1-消息模型（Message-Model）" class="headerlink" title="1 消息模型（Message Model）"></a>1 消息模型（Message Model）</h4><p>RocketMQ主要由 Producer、Broker、Consumer 三部分组成，其中Producer 负责生产消息，Consumer 负责消费消息，Broker 负责存储消息。Broker 在实际部署过程中对应一台服务器，每个 Broker 可以存储多个Topic的消息，每个Topic的消息也可以分片存储于不同的 Broker。Message Queue 用于存储消息的物理地址，每个Topic中的消息地址存储于多个 Message Queue 中。ConsumerGroup 由多个Consumer 实例构成。</p>
<h4 id="2-消息生产者（Producer）"><a href="#2-消息生产者（Producer）" class="headerlink" title="2 消息生产者（Producer）"></a>2 消息生产者（Producer）</h4><p> 负责生产消息，一般由业务系统负责生产消息。一个消息生产者会把业务应用系统里产生的消息发送到broker服务器。RocketMQ提供多种发送方式，同步发送、异步发送、顺序发送、单向发送。同步和异步方式均需要Broker返回确认信息，单向发送不需要。</p>
<h4 id="3-消息消费者（Consumer）"><a href="#3-消息消费者（Consumer）" class="headerlink" title="3 消息消费者（Consumer）"></a>3 消息消费者（Consumer）</h4><p> 负责消费消息，一般是后台系统负责异步消费。一个消息消费者会从Broker服务器拉取消息、并将其提供给应用程序。从用户应用的角度而言提供了两种消费形式：拉取式消费、推动式消费。</p>
<h4 id="4-主题（Topic）"><a href="#4-主题（Topic）" class="headerlink" title="4 主题（Topic）"></a>4 主题（Topic）</h4><p>  表示一类消息的集合，每个主题包含若干条消息，每条消息只能属于一个主题，是RocketMQ进行消息订阅的基本单位。</p>
<h4 id="5-代理服务器（Broker-Server）"><a href="#5-代理服务器（Broker-Server）" class="headerlink" title="5 代理服务器（Broker Server）"></a>5 代理服务器（Broker Server）</h4><p>消息中转角色，负责存储消息、转发消息。代理服务器在RocketMQ系统中负责接收从生产者发送来的消息并存储、同时为消费者的拉取请求作准备。代理服务器也存储消息相关的元数据，包括消费者组、消费进度偏移和主题和队列消息等。</p>
<h4 id="6-名字服务（Name-Server）"><a href="#6-名字服务（Name-Server）" class="headerlink" title="6 名字服务（Name Server）"></a>6 名字服务（Name Server）</h4><p> 名称服务充当路由消息的提供者。生产者或消费者能够通过名字服务查找各主题相应的Broker IP列表。多个Namesrv实例组成集群，但相互独立，没有信息交换。</p>
<h4 id="7-拉取式消费（Pull-Consumer）"><a href="#7-拉取式消费（Pull-Consumer）" class="headerlink" title="7 拉取式消费（Pull Consumer）"></a>7 拉取式消费（Pull Consumer）</h4><p>  Consumer消费的一种类型，应用通常主动调用Consumer的拉消息方法从Broker服务器拉消息、主动权由应用控制。一旦获取了批量消息，应用就会启动消费过程。</p>
<h4 id="8-推动式消费（Push-Consumer）"><a href="#8-推动式消费（Push-Consumer）" class="headerlink" title="8 推动式消费（Push Consumer）"></a>8 推动式消费（Push Consumer）</h4><p> Consumer消费的一种类型，该模式下Broker收到数据后会主动推送给消费端，该消费模式一般实时性较高。</p>
<h4 id="9-生产者组（Producer-Group）"><a href="#9-生产者组（Producer-Group）" class="headerlink" title="9 生产者组（Producer Group）"></a>9 生产者组（Producer Group）</h4><p>  同一类Producer的集合，这类Producer发送同一类消息且发送逻辑一致。如果发送的是事务消息且原始生产者在发送之后崩溃，则Broker服务器会联系同一生产者组的其他生产者实例以提交或回溯消费。</p>
<h4 id="10-消费者组（Consumer-Group）"><a href="#10-消费者组（Consumer-Group）" class="headerlink" title="10 消费者组（Consumer Group）"></a>10 消费者组（Consumer Group）</h4><p>  同一类Consumer的集合，这类Consumer通常消费同一类消息且消费逻辑一致。消费者组使得在消息消费方面，实现负载均衡和容错的目标变得非常容易。要注意的是，消费者组的消费者实例必须订阅完全相同的Topic。RocketMQ 支持两种消息模式：集群消费（Clustering）和广播消费（Broadcasting）。</p>
<h4 id="11-集群消费（Clustering）"><a href="#11-集群消费（Clustering）" class="headerlink" title="11 集群消费（Clustering）"></a>11 集群消费（Clustering）</h4><p>集群消费模式下,相同Consumer Group的每个Consumer实例平均分摊消息。</p>
<h4 id="12-广播消费（Broadcasting）"><a href="#12-广播消费（Broadcasting）" class="headerlink" title="12 广播消费（Broadcasting）"></a>12 广播消费（Broadcasting）</h4><p>广播消费模式下，相同Consumer Group的每个Consumer实例都接收全量的消息。</p>
<h4 id="13-普通顺序消息（Normal-Ordered-Message）"><a href="#13-普通顺序消息（Normal-Ordered-Message）" class="headerlink" title="13 普通顺序消息（Normal Ordered Message）"></a>13 普通顺序消息（Normal Ordered Message）</h4><p>普通顺序消费模式下，消费者通过同一个消费队列收到的消息是有顺序的，不同消息队列收到的消息则可能是无顺序的。</p>
<h4 id="14-严格顺序消息（Strictly-Ordered-Message）"><a href="#14-严格顺序消息（Strictly-Ordered-Message）" class="headerlink" title="14 严格顺序消息（Strictly Ordered Message）"></a>14 严格顺序消息（Strictly Ordered Message）</h4><p>严格顺序消息模式下，消费者收到的所有消息均是有顺序的。</p>
<h4 id="15-消息（Message）"><a href="#15-消息（Message）" class="headerlink" title="15 消息（Message）"></a>15 消息（Message）</h4><p>消息系统所传输信息的物理载体，生产和消费数据的最小单位，每条消息必须属于一个主题。RocketMQ中每个消息拥有唯一的Message ID，且可以携带具有业务标识的Key。系统提供了通过Message ID和Key查询消息的功能。</p>
<h4 id="16-标签（Tag）"><a href="#16-标签（Tag）" class="headerlink" title="16 标签（Tag）"></a>16 标签（Tag）</h4><p> 为消息设置的标志，用于同一主题下区分不同类型的消息。来自同一业务单元的消息，可以根据不同业务目的在同一主题下设置不同标签。标签能够有效地保持代码的清晰度和连贯性，并优化RocketMQ提供的查询系统。消费者可以根据Tag实现对不同子主题的不同消费逻辑，实现更好的扩展性。</p>
<h3 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h3><h4 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h4><h5 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h5><p><a href="http://rocketmq.apache.org/dowloading/releases/" target="_blank" rel="noopener">下载地址</a></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">wget https://downloads.apache.org/rocketmq/4.8.0/rocketmq-all-4.8.0-bin-release.zip</span><br><span class="line"><span class="comment"># 解压</span></span><br><span class="line">unzip rocketmq-all-4.8.0-bin-release.zip</span><br></pre></td></tr></table></figure>
<h5 id="安装JDK环境"><a href="#安装JDK环境" class="headerlink" title="安装JDK环境"></a>安装JDK环境</h5><p>Java8的环境 <a href="https://www.yangzhenyu.com.cn/605/#linux%E7%89%88%E6%9C%AC">安装指南</a></p>
<h5 id="MQ配置环境变量"><a href="#MQ配置环境变量" class="headerlink" title="MQ配置环境变量"></a>MQ配置环境变量</h5><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加入环境变量</span></span><br><span class="line"><span class="built_in">export</span> ROCKETMQ_HOME=/opt/rocketmq-all-4.8.0-bin-release</span><br><span class="line"><span class="comment"># 下面这个不是必须要的</span></span><br><span class="line"><span class="built_in">export</span> NAMESRV_ADDR=localhost:9876</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$ROCKETMQ_HOME</span>/bin</span><br><span class="line"></span><br><span class="line"><span class="comment">#保存</span></span><br><span class="line">:wq -&gt; enter</span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>
<h5 id="配置修改"><a href="#配置修改" class="headerlink" title="配置修改"></a>配置修改</h5><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 进入bin目录</span></span><br><span class="line"><span class="built_in">cd</span> /bin</span><br><span class="line"><span class="comment"># 修改 启动server的脚本</span></span><br><span class="line">vim runserver.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改这一行</span></span><br><span class="line">JAVA_OPT=<span class="string">"<span class="variable">$&#123;JAVA_OPT&#125;</span> -server -Xms512m -Xmx512m -Xmn256m -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=320m"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认是2G 做测试的时候不需要这么大</span></span><br><span class="line"><span class="comment"># 修改为512M</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#保存</span></span><br><span class="line">:wq -&gt; enter</span><br><span class="line"></span><br><span class="line">vim runbroker.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改这一行</span></span><br><span class="line">JAVA_OPT=<span class="string">"<span class="variable">$&#123;JAVA_OPT&#125;</span> -server -Xms512m -Xmx512m -Xmn256m"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认是4G 做测试的时候不需要这么大</span></span><br><span class="line"><span class="comment"># 修改为512M</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#保存</span></span><br><span class="line">:wq -&gt; enter</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改broker配置文件</span></span><br><span class="line">vim /conf/broker.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在末尾加上一行</span></span><br><span class="line"><span class="comment"># 允许自己创建Topic 方便测试</span></span><br><span class="line">autoCreateTopicEnable = <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h5 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h5><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 后台启动nameserver</span></span><br><span class="line">nohup mqnamesrv &amp; </span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看日志</span></span><br><span class="line">cat nohup.out</span><br><span class="line"><span class="comment"># The Name Server boot success. serializeType=JSON</span></span><br><span class="line"><span class="comment"># 出现这行说明启动成功</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 后台启动nameserver</span></span><br><span class="line">nohup mqbroker -c ../conf/broker.conf &amp; </span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看日志</span></span><br><span class="line">cat nohup.out</span><br><span class="line"><span class="comment"># The broker[broker-a, 10.10.10.154:10911] boot success. serializeType=JSON and name server is localhost:9876</span></span><br><span class="line"><span class="comment"># 出现这行说明启动成功</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>单机运行启动成功</p>
</blockquote>
<h4 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h4><h5 id="下载-1"><a href="#下载-1" class="headerlink" title="下载"></a>下载</h5><p><a href="https://www.apache.org/dyn/closer.cgi?path=rocketmq/4.8.0/rocketmq-all-4.8.0-bin-release.zip" target="_blank" rel="noopener">下载地址</a></p>
<p>解压到一个目录</p>
<h5 id="安装JDK环境-1"><a href="#安装JDK环境-1" class="headerlink" title="安装JDK环境"></a>安装JDK环境</h5><p>Java8的环境 <a href="https://www.yangzhenyu.com.cn/605/#windows%E7%89%88%E6%9C%AC">安装指南</a></p>
<h5 id="MQ配置环境变量-1"><a href="#MQ配置环境变量-1" class="headerlink" title="MQ配置环境变量"></a>MQ配置环境变量</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">计算机→属性→高级系统设置→高级→环境变量</span><br><span class="line">系统变量→新建 ROCKETMQ_HOME 变量 。</span><br><span class="line">变量值填写jdk的安装目录（C:\Development\rocketmq-all-4.8.0-bin-release)</span><br></pre></td></tr></table></figure>
<h5 id="配置修改-1"><a href="#配置修改-1" class="headerlink" title="配置修改"></a>配置修改</h5><p>修改文件夹bin里的runbroker.cmd</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 修改默认大小</span><br><span class="line">set &quot;JAVA_OPT=%JAVA_OPT% -server -Xms512m -Xmx512m -Xmn256m&quot;</span><br><span class="line"># 在%CLASSPATH% 左右各加一个引号 不然启动broker会显示找不到主方法</span><br><span class="line">set &quot;JAVA_OPT=%JAVA_OPT% -cp &quot;%CLASSPATH%&quot;&quot;</span><br></pre></td></tr></table></figure>
<p>修改文件夹bin里的runserver.cmd</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 修改默认大小</span><br><span class="line">set &quot;JAVA_OPT=%JAVA_OPT% -server -Xms512m -Xmx512m -Xmn256m -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=320m&quot;</span><br><span class="line"># 在%CLASSPATH% 左右各加一个引号 不然启动broker会显示找不到主方法</span><br><span class="line">set &quot;JAVA_OPT=%JAVA_OPT% -cp &quot;%CLASSPATH%&quot;&quot;</span><br></pre></td></tr></table></figure>
<p>修改文件夹conf里的broker.conf</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 增加一行broker.conf</span><br><span class="line">autoCreateTopicEnable = true</span><br></pre></td></tr></table></figure>
<h5 id="启动-1"><a href="#启动-1" class="headerlink" title="启动"></a>启动</h5><p>双击bin目录下mqnamesrv.cmd</p>
<p><img src="http://img.yzy.ink/image-20210308153845449.png" alt="image-20210308153845449"></p>
<p>启动完成</p>
<p>双击bin目录下mqbroker.cmd</p>
<p><img src="http://img.yzy.ink/image-20210308153934452.png" alt="image-20210308153934452"></p>
<p>启动完成</p>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>使用bin目录下的tools</p>
<h5 id="提供者-会发送1000条消息到broker"><a href="#提供者-会发送1000条消息到broker" class="headerlink" title="提供者 会发送1000条消息到broker"></a>提供者 会发送1000条消息到broker</h5><p>windows</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">.\bin\tools.cmd  org.apache.rocketmq.example.quickstart.Producer</span><br></pre></td></tr></table></figure>
<p>linux</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/bin/tools org.apache.rocketmq.example.quickstart.Producer</span><br></pre></td></tr></table></figure>
<p><img src="http://img.yzy.ink/image-20210308154533798.png" alt="image-20210308154533798"></p>
<h5 id="消费者-会接受1000条消息"><a href="#消费者-会接受1000条消息" class="headerlink" title="消费者 会接受1000条消息"></a>消费者 会接受1000条消息</h5><p>windows</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.\bin\tools.cmd org.apache.rocketmq.example.quickstart.Consumer</span><br></pre></td></tr></table></figure>
<p>linux</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/bin/tools org.apache.rocketmq.example.quickstart.Consumer</span><br></pre></td></tr></table></figure>
<p><img src="http://img.yzy.ink/image-20210308154549175.png" alt="image-20210308154549175"></p>
<blockquote>
<p>测试完成</p>
</blockquote>
<h3 id="可视化服务"><a href="#可视化服务" class="headerlink" title="可视化服务"></a>可视化服务</h3><h4 id="仓库地址"><a href="#仓库地址" class="headerlink" title="仓库地址"></a><a href="https://github.com/apache/rocketmq-externals" target="_blank" rel="noopener">仓库地址</a></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 拉取仓库</span><br><span class="line">git clone https://github.com/apache/rocketmq-externals</span><br></pre></td></tr></table></figure>
<h4 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h4><p>mavne编译 <a href="https://github.com/apache/rocketmq-externals/tree/master/rocketmq-console" target="_blank" rel="noopener">rocketmq-console</a> 项目</p>
<h4 id="启动-2"><a href="#启动-2" class="headerlink" title="启动"></a>启动</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">java -jar rocketmq-console-ng-2.0.0.jar</span><br></pre></td></tr></table></figure>
<h4 id="查看"><a href="#查看" class="headerlink" title="查看"></a>查看</h4><p><img src="http://img.yzy.ink/image-20210308155955930.png" alt="image-20210308155955930"></p>
<p>web端页面</p>
<p><img src="http://img.yzy.ink/image-20210308160027768.png" alt="image-20210308160027768"></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">杨振宇</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.yangzhenyu.com.cn/46089/">https://www.yangzhenyu.com.cn/46089/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.yangzhenyu.com.cn">杨振宇'Blog</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/分布式/">分布式</a><a class="post-meta__tags" href="/tags/mq/">mq</a><a class="post-meta__tags" href="/tags/消息队列/">消息队列</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="https://raw.githubusercontent.com/yttrium2016/img/master/20190222151401.png"><div class="post-qr-code__desc">支付宝打赏</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="https://raw.githubusercontent.com/yttrium2016/img/master/20190222151504.png"><div class="post-qr-code__desc">微信打赏</div></div></div><div class="social-share pull-right"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/35693/"><i class="fa fa-chevron-left">  </i><span>学习手写RPC框架</span></a></div><div class="next-post pull-right"><a href="/54854/"><span>Mysql主从模式</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: '34b21ee58acdcdea4814',
  clientSecret: 'edcdb38266a1aac9885209a7f34bad5c4ea06c0a',
  repo: 'yttrium2016.github.io',
  owner: 'yttrium2016',
  admin: 'yttrium2016',
  id: md5(decodeURI(location.pathname)),
  language: 'zh-CN'
})
gitalk.render('gitalk-container')</script></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2022 By 杨振宇</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="icp"><a href="https://beian.miit.gov.cn"><span>浙ICP备16002000号-3</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>